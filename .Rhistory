library(snakecase)
do_region = regions_lookup %>%
filter(nhs_region == myregion) %>%
select(nhs_region, DAG_name = redcap_data_access_group_label, DAG_id = data_access_group_id) %>%
mutate(source_project = mysource, target_project = mytarget,
sql_onedag = glue(sql),
filename = to_snake_case(DAG_name))
source('~/Dropbox (Research Team - University of Edinburgh)/Harrison-group shared/Covid/isaric_hospitals/redcap_split_project/create_sql_each_DAG.R', echo=TRUE)
do_region %>%
filter(DAG_id == 122) %>%
pull(sql_onedag) %>%
write_file("test.sql")
View(do_region)
do_region = regions_lookup %>%
filter(nhs_region == myregion) %>%
select(nhs_region, DAG_name = redcap_data_access_group_label, DAG_id = data_access_group_id) %>%
mutate(source_project = mysource, target_project = mytarget,
sql_onedag = glue(sql),
filename = paste0(to_snake_case(DAG_name), ".sql"))
do_region
for (myfilename in do_region$filename){
print(myfilename)
# do_region %>%
#   filter(filename == myfilename) %>%
#   pull(sql_onedag) %>%
#   write_file(myfilename)
}
for (myfilename in do_region$filename){
print(myfilename)
do_region %>%
filter(filename == myfilename) %>%
pull(sql_onedag) %>%
write_file(myfilename)
}
paste0(to_snake_case(myregion), myfilename, sep = "/")
paste(to_snake_case(myregion), myfilename, sep = "/")
system(paste("mkdir", to_snake_case(myregion)))
for (myfilename in do_region$filename){
print(myfilename)
do_region %>%
filter(filename == myfilename) %>%
pull(sql_onedag) %>%
write_file(paste(to_snake_case(myregion), myfilename, sep = "/"))
}
